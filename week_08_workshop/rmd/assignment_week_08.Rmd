---
title: "Workshop 8: Grouping and Pivoting"
output:
  prettydoc::html_pretty:
    theme: architect
    toc: true
    number_sections: true
author: "Author's name here"
date: "2023-06-28"
editor_options: 
  chunk_output_type: inline
  markdown: 
    wrap: 72
---

```{r include = FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

# Load packages and data

To get started, **load in the needed packages**: {tidyverse}, {here},
and {esquisse}.

```{r}
#Load packages
"WRITE_YOUR_CODE_HERE"
```

Now, **read the dataset into R**. The data frame you import should have
61 rows and 9 columns. Remember to use the `here()` function to allow
your Rmd to use project-relative paths.

```{r}
#Load dataset
diet_raw <- "WRITE_YOUR_CODE_HERE"
```

**Checkpoint:** Pay close attention to variable names in the data frame!
Although the variables are consistently named, notice that there are [no
neat separators]{.underline}. This will be important in later steps of
the assignment so keep this detail in mind.



# 1 More Practice Using `dplyr` Verbs!

NOTE: Keep in mind that the raw dataset is in a WIDE format while you
complete Exercise 1.


## Exercise 1: Dietary Intake of Households

### 1.1
Measurements for energy as well as the water, fat, and dry content of
foods were recorded during the first and second visit of households. Use
`dplyr` verbs to calculate the total energy, water, fat, and dry content
of foods consumed per household. You should have 4 new variables in the end.

```{r}
diet_clean1 <- diet_raw %>% "WRITE_YOUR_CODE_HERE"
```

**Checkpoint:** The original dataset had 9 columns. You should now have a total of 13 columns in your dataset! Note that the number of rows should remain unchanged.

### 1.2
Determine which 2 households which had the highest fat intake. HINT: Consider the `arrange()` function.

```{r}
diet_clean2 <- diet_clean1 %>% "WRITE_YOUR_CODE_HERE"
```

#### 1.3
For each of the 2 households, what are the corresponding mean energy consumption? 
```{r}
diet_clean3 <- diet_clean2 %>%  "WRITE_YOUR_CODE_HERE"
```


# 2 Pivoting the Dataset

## Exercise 2: Wide to Long format

Although basic data analysis tasks such as finding the mean, etc. are
possible on wide format datasets, the codes are often longer and involve
more manipulation.

Long format datasets are optimal for a majority of data analysis tasks.

Pivot the raw data frame into a long format using the `pivot_longer()`
function. Assign appropriate names to describe what variables contain
using the `names_to()` and `values_to()` arguments.

But first! Recall that there are no neat separators for variable names. Think about how you
would make one to pivot the data frame into a long format.

HINT: Consider the `rename()` function of {dplyr}.

### 2.1
```{r eval = F}
#Rename variable using the rename function
diet_raw_renamed <- diet_raw %>% "WRITE_YOUR_CODE_HERE"
```

```{r}
# Pivot into a long data frame
diet_long <- diet_raw_named %>% "WRITE_YOUR_CODE_HERE"
```

**Checkpoint:** After pivoting the data frame, notice that the number of observations and variables have changed! You should now have a 488 observations and 4 variables.

### 2.2 Basic data analysis with a long format dataset

What are the median and median values for each observed variable: 
  - Energy content of food
  - Dry content of food
  - Water content of food 
  - Fat content of food 

```{r}
sum_diet_long <- diet_long %>% "WRITE_YOUR_CODE_HERE"
```


### 2.3 Visualize data with {esquisse}

Using `esquisse`, plot the mean energy content vs. mean fat content of food consumed for all households.
```{r}
"PASTE THE ESQUISSE CODE HERE"
```


# Exercise: 3 Long to Wide format

With the long data set you created in Exercise 2, pivot it back to a WIDE format dataset using the `pivot_wider` function alongside the `names_from` and `values_from` arguments.

```{r}
# Pivot into a wide data frame
diet_raw_wide <- diet_long %>% "WRITE_YOUR_CODE_HERE"
```



# Wrap up

That's it for this assignment! We will choose 2-3 people to present your
work during the workshop. If you would like to share your results with
the class, please let an instructor know.

# Submission: Upload Rmd file

Don't forget to save your answers and upload your assignment Rmd on the
workshop webpage. You should upload just one Rmd file with your answers
(do not upload the knitted HTML or a zipped folder). Make sure to
include your name in the YAML header at the top of the script.
