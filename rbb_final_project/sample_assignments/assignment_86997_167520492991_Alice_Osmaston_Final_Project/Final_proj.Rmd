---
title: "Domestic Violence Against Women in Peru"
subtitle: "Findings from the 2018 Demographic and Health Survey"
author: "Alice osmaston"
date: "2023-01-16"
output:
  prettydoc::html_pretty:
    theme: architect
    toc: TRUE
    number_sections: TRUE
editor_options: 
  markdown: 
    wrap: 72
---

```{r echo = F}
knitr::opts_chunk$set(echo = F, warning = F, message = F)
```

```{r setup}

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
## Packages ----
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

if(!require(pacman)) install.packages("pacman")
pacman::p_load(janitor, # data analysis utilities
               here, # force rmds to use the project folder as working directory
               haven, # for reading in stata files
               scales, # for the comma() function, among others
               ggstatsplot, # for pie charts
               patchwork, # combining plots
               tidyverse # for everything!
               )

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
# ggplot2 palette  ----
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

# manual color scale for use later. 
# Got the scale for this website: # https://mycolor.space/?hex=%2354B1BF&sub=1
my_palette <- c("#65D76D","#34AB45","#00821D","#005900","#003400")

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
# Import and process data  ----
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
# Explore first all columns with only 300 rows. Or investigate using .MAP file
ir_raw <- read_dta(here("data/peir6ifl.dtA"),
                          n_max = 300)

# Import only selected columns 
ir_selected_cols <- read_dta(here("data/peir6ifl.dtA"),
                          col_select = c(v012, v013, v024, v044, v102, v106, v190, v502, d102, d104, d105a, d105b, d105c, d105d, d105e, d105f, d105g, d105h, d105i, d115b, d115c, d115d, d115e, d115f, d115g, d115h, d115i, d115j, d115m, d115n, d115o, d115p, d115s, d115t, d115v, d115w, d115x, d115xa, d115xb, d115xc, d119a, d119b, d119c, d119f, d119g, d119o, d119p, d119q, d119r, d119s, d119u, d119x, d119xi, d119xj))

library(dplyr)

# convert from labelled data to regular factors (passes the whole data frame)
ir_converted <- 
  ir_selected_cols %>%
  as_factor() %>% 
  dplyr::rename(age = v012, # in yrs
         agegrp5 = v013, # 7 groups spanning age 15-49
         region = v024, # 25 regions
         ever_married = v502, # reduce 3  categories to 2 
         urban_1rural_2 = v102, 
         wealth_index = v190, # categories 1=poorest
         highest_educ =v106, # 4 categories + MISSING
         abuse_questions = v044, # simplify
         abuse_control = d102, # 1-6 -> simplify to binary
         abuse_emotional = d104, # yes/no
         ) %>% 
  # simplify marriage categories
  dplyr::mutate(
    # ever_married = as.character(ever_married), # why do I need it to be a character???????
    ever_married = case_when(
      ever_married %in% c("currently married", "formerly married") ~ "ever married",
      ever_married =="never married" ~ "never married"), #TRUE ~ ever_married# what does this mean????????????????
    abuse_control = case_when( # seems to work fine when I don't change it to character
      abuse_control == 0 ~ "no",
      abuse_control %in% c("1", "2", "3", "4", "5", "6") ~ "yes"),
    # abuse_questions = as.character(abuse_questions),
    abuse_questions = case_when(
      abuse_questions %in% c("woman not selected", "woman selected, but privacy not possible", "woman selected, but not interviewed") ~ "no",
      abuse_questions == "woman selected and interviewed" ~ "yes"))
    
ir_converted$abuse_physical <- dplyr::case_when(
  ir_converted$d105a %in% c("often", "sometimes", "yes, widow/frequency missing") | ir_converted$d105b %in% c("often", "sometimes", "yes, widow/frequency missing") | ir_converted$d105c %in% c("often", "sometimes", "yes, widow/frequency missing") | ir_converted$d105d %in% c("often", "sometimes", "yes, widow/frequency missing") | ir_converted$d105e %in% c("often", "sometimes", "yes, widow/frequency missing") | 
    ir_converted$d105f %in% c("often", "sometimes", "yes, widow/frequency missing") |
    ir_converted$d105g %in% c("often", "sometimes", "yes, widow/frequency missing") |
    ir_converted$d105h %in% c("often", "sometimes", "yes, widow/frequency missing") |
     ir_converted$d105i %in% c("often", "sometimes", "yes, widow/frequency missing") ~ "yes",
  ir_converted$d105a %in% c("no", "not at all") & ir_converted$d105b %in% c("no", "not at all") & ir_converted$d105c %in% c("no", "not at all") & ir_converted$d105d %in% c("no", "not at all") & ir_converted$d105e %in% c("no", "not at all") & ir_converted$d105f %in% c("no", "not at all") & ir_converted$d105g %in% c("no", "not at all") & ir_converted$d105h %in% c("no", "not at all") & ir_converted$d105i %in% c("no", "not at all") ~ "no"
)

ir_converted$abuse_any <- case_when(
      ir_converted$abuse_physical == "yes" | ir_converted$abuse_control == "yes" | ir_converted$abuse_emotional == "yes" ~ "yes",
      ir_converted$abuse_physical == "no" & ir_converted$abuse_control == "no" & ir_converted$abuse_emotional == "no" ~ "no")

# Dataframe with variables for further analyses
ir_compressed <- ir_converted %>% 
  mutate(
    abuse_any = as.factor(abuse_any),
    abuse_control = as.factor(abuse_control)) %>% 
  select(abuse_questions, ever_married, age, agegrp5, urban_1rural_2, region, wealth_index, highest_educ, abuse_any, abuse_control, abuse_emotional, abuse_physical)
```

```{r}
##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##  Age of abuse-victims ----
##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

num_women_in_survey <- nrow(ir_converted)
num_asked_abuse <- ir_converted %>% filter(abuse_questions == "yes") %>% nrow()
num_suffered_abuse <- ir_converted %>% filter(abuse_any == "yes") %>% nrow()
pct_suffered_abuse <- (100 * num_suffered_abuse/num_asked_abuse) %>% round(digits = 1)
mean_sd_no_abuse <- 
  ir_converted %>% filter(abuse_questions == "yes") %>% 
    filter(abuse_any == "yes") %>% 
    summarise(mean_age_no_abuse = round(mean(age), digits = 2), 
                   sd_age_no_abuse = round(sd(age), digits = 2))
mean_sd_abuse <- 
  ir_converted %>% filter(abuse_questions == "yes") %>% 
  filter(abuse_any == "no") %>% 
  summarise(mean_age_abuse = round(mean(age), digits = 2), 
                   sd_age_abuse = round(sd(age), digits = 2))


# Violin plot of abuse_any vs age
complete_cases <- ir_compressed %>% drop_na()  # only using complete cases
gg_violin_age_abuse <- 
  ggplot(complete_cases,
         aes(x=age,
             y=abuse_any,
             color=abuse_any,
             alpha=0)) +
  geom_violin()  +
  labs(title = "Comparison of age distribution between victims and non-victims",
       x = "Women's age (years)", y = "Experienced abuse") +
  theme(legend.position = "none") +
  scale_color_manual(values=c("#65D76D","#003400")) +
  scale_x_continuous(n.breaks = 10,
                     minor_breaks = seq(15,50,1)) +
  scale_y_discrete(labels=c("no"="No","yes"="Yes")) +
  coord_flip() +
  theme(panel.grid.minor.x = element_blank())
```

# Age distribution of abuse victims

The following analyses focus on women who were selected for the domestic
violence module of the DHS survey and were ever-married (defined as
currently or previously living with a partner). Where multiple women per
household qualified, only one per household was asked. Therefore, out of
the total `r comma(num_women_in_survey)` women surveyed (ages 15 to 49),
`r comma(num_asked_abuse)` were asked the domestic violence questions,
and of those, `r comma(num_suffered_abuse)` (`r pct_suffered_abuse`%)
were victims of some form of manipulative control, or emotional or
physical violence.

```{r fig.height = 4, width = 4}
#| fig.cap = "Figure 1. Age distribution of women who reported experiencing abuse compared with those who did not."
gg_violin_age_abuse
```

Figure 1 shows the age distribution of domestic violence victims
compared to non-victims. The mean age of victims was
`r mean_sd_abuse$mean_age_abuse` years, with a standard deviation of
`r mean_sd_abuse$sd_age_abuse`, versus
`r mean_sd_no_abuse$mean_age_no_abuse` years and
`r mean_sd_no_abuse$sd_age_no_abuse` for those who did not report any
form of abuse.

```{r help seeking}
# pivot longer the help seeking variables
help_sources <- ir_selected_cols %>%
  select(d119a, d119b, d119c, d119f, d119g, d119o, d119p, d119q, d119r, d119s, d119u, d119x, d119xi, d119xj) %>%  
  colSums(na.rm =T) 

help_sources <- data.frame(source=c("Mother", "Father", "Sister", "Brother", "Neighbour", "Other"),
                                           number=c(973, 415, 383, 359, 551, 1410)) %>% 
  mutate(
    source = factor(source, 
                  levels = c("Other", "Mother", "Neighbour", "Father", "Sister", "Brother")))


num_seek_mother = 973
num_seek_fem_rel = 313

  gg_col_help_seeking <- 
  help_sources %>% 
  ggplot(aes(y = source, x = number, fill = "65D76D")) + 
  geom_col() +
  labs(title = "Help-seeking practices of abuse victims", 
       x = "Number of abuse victims", 
       y = "Trusted person") +
  theme_classic() + 
  theme(legend.position = "none",
        axis.line.y = element_line(),
        panel.grid.minor.y = element_blank()) +
  scale_x_continuous(n.breaks = 8) +
  scale_fill_manual(values = rev(my_palette)) 
  
     
#   pivot_longer(d119a:d119xj, names_to = "help sources", values_to = "count") %>% 
#   mutate(count = as.numeric(as.character(count))) # convert to numerical
# # sort
# sorted_help_sources <- help_sources[order("help sources"),]
# sorted_help_sources <- help_sources[order(count),]
# sorted_help_sources <- order(help_sources[,"count"])
# sorted_help_sources <- order(help_sources$count, na.last=T)
```

# From whom victims of abuse seek help

```{r fig.height = 4, width = 4}
#| fig.cap = "Figure 2. Help-seeking practices of abuse victims"
gg_col_help_seeking
```

Figure 2 shows the 5 most popular people from whom victims of abuse keep
help. The most common single source of help is the victim's mother;
`r num_seek_mother` people reported doing so. 'Other' accounts for a
largo proportion of the help-seeking behaviour and this category
consists of 8 other potential sources of help, the highest of which is a
female relative, whom `r num_seek_fem_rel` people reported. Groups
included in the 'other' category are as follows:

-   Husband
-   Daughter
-   Son
-   Own family
-   Step-mother
-   Step-father
-   Female friend
-   Male friend

```{r}
##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##  Types of Abuse ----
##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_abuse_control <- complete_cases %>% filter(abuse_control == "yes") %>% nrow()
num_abuse_emotional <- complete_cases %>% filter(abuse_emotional == "yes") %>% nrow()
num_abuse_physical <- complete_cases %>% filter(abuse_physical == "yes") %>% nrow()

```

```{r Distribution of physical abuse across residence type}
# data prep for residence abuse chart
residence_abuse <- 
  complete_cases %>% 
  # Subset to victims
  filter(abuse_physical == "yes") %>% 
  mutate(
         # set factor level order
         residence = factor(urban_1rural_2, levels = c("urban", "rural")))
# calculate pct of women living in urban areas
total_living <- ir_compressed %>% select(urban_1rural_2) %>% nrow()
num_urban <- ir_compressed %>% filter(urban_1rural_2 == "urban") %>% nrow()
pct_urban <- (100 * num_urban/total_living) %>% round(digits = 1)
# calculate pct of physical abuse victims living in urban
count_women_abuse_phys <- complete_cases %>% filter(abuse_physical == "yes") %>% nrow() 


### Urban/rural percentage pie chart ----

gg_pie_residence_abuse  <- 
  residence_abuse %>%
  ggstatsplot::ggpiestats(
    x = residence,
    title = "Proportions of physical abuse victims who live in urban versus rural areas",
    results.subtitle = F # turn off statistical tests
    ) +
  labs(fill = "Urbanicity") + 
  theme(axis.line.x.bottom = element_blank(), 
        legend.position = "right") +
  scale_fill_manual(values = c("#65D76D","#00821D"))  +
  theme_void()

# data prep for education abuse pie chart

education_abuse <- 
  complete_cases %>% 
  # Subset to victims
  filter(abuse_physical == "yes") %>% 
  mutate(
         # set factor level order
         education = factor(highest_educ, levels = c("no education", "primary", "secondary", "higher")))
# calculate pct of women attended higher
total_educ <- ir_compressed %>% select(highest_educ) %>% nrow()
num_higher <- ir_compressed %>% filter(highest_educ == "higher") %>% nrow()
pct_higher <- (100 * num_higher/total_educ) %>% round(digits = 1)
# calculate pct of physical abuse victims who attended higher educ
count_women_abuse_phys <- complete_cases %>% filter(abuse_physical == "yes") %>% filter(highest_educ == "higher") %>% nrow() 


### Education percentage pie chart 

gg_pie_education_abuse  <- 
  education_abuse %>%
  ggstatsplot::ggpiestats(
    x = education,
    title = "Proportions of physical abuse victims among different levels of education",
    results.subtitle = F # turn off statistical tests
    ) +
  labs(fill = "Highest education") + 
  theme(axis.line.x.bottom = element_blank(), 
        legend.position = "right") +
  scale_fill_manual(values = c("#65D76D","#00821D", "#005900","#003400"))  +
  guides(fill = guide_legend(reverse=T)) + # legend order (can be found by Googling "how do I reverse legend order in ggplot") 
  theme_void()

# Combine plots
gg_phys_abuse <- 
  patchwork::wrap_plots(gg_pie_residence_abuse, 
                        gg_pie_education_abuse, 
                        ncol = 1) + 
  plot_annotation(tag_levels = 'a')

```

# Subset analysis of physical abuse victims

```{r fig.height = 8, width = 4}
#| fig.cap = "Figure 3. Pie charts to show distribution of physical abuse victims across education levels and urbanicity. "
gg_phys_abuse
```

Figure 3a shows that while (`r pct_urban`%) of Peru's population live in
urban areas (total`r comma(total_living)`), the percentage of physical
abuse against people living in urban areas is slightly lower, at 63%.

Figure 3b shows that the lowest education level corresponds to the
lowest proportion of physical abuse victims, while those who reached
secondary education account for the largest proportion.

# Median age of victims of abuse by wealth category

```{r abuse victims age by wealth cat}
## Calculate proportion of women who have suffered each type of abuse

### Abusive Control----
count_women_abuse_control <- complete_cases %>% filter(abuse_control == "yes") %>% nrow() 
pct_women_abuse_control <- (100 * count_women_abuse_control/num_asked_abuse) %>% round(1) # 51.6%
median_age_abuse_control <- complete_cases %>%
  filter(abuse_control =="yes") %>%
  summarise(median(age, na.rm = T))

### Emotional----
count_women_abuse_emotional <- complete_cases %>% filter(abuse_emotional == "yes") %>% nrow() 
pct_women_abuse_emotional <- (100 * count_women_abuse_emotional/num_asked_abuse) %>% round(1) # 23.6%
median_age_abuse_emotional <- complete_cases %>%
  filter(abuse_emotional =="yes") %>%
  summarise(median(age, na.rm = T))
### Physical----
count_women_abuse_physical <- complete_cases %>% filter(abuse_physical == "yes") %>% nrow() 
pct_women_abuse_physical <- (100 * count_women_abuse_physical/num_asked_abuse) %>% round(1) # 10.2%
median_age_abuse_physical <- complete_cases %>%
  filter(abuse_physical =="yes") %>%
  summarise(median(age, na.rm = T))

# Types of abuse per wealth group
gg_col_abuse_per_wealth_group <-
  complete_cases %>% 
  group_by(wealth_index) %>% 
  summarise(
    med_age_abuse_control = median(age, na.rm = T),
    med_age_abuse_emotional = median(age, na.rm = T),
    med_age_abuse_physical = median(age, na.rm = T)
  ) %>% 
  # Pivot short to long
  pivot_longer(2:4) %>% 
  # set the levels to keep the order consistent on ggplot
  mutate(name = factor(name,
                       levels = c("med_age_abuse_control", 
                                  "med_age_abuse_emotional", 
                                  "med_age_abuse_physical"))) %>% 
  ggplot() + 
  geom_col(aes(x = name, y = value, fill = wealth_index), position = "dodge") + 
  geom_text(aes(x = name, y = value - 1.2, group = wealth_index, label = value), 
            size = 3.8, fontface = "bold", color = "white",
            position = position_dodge(width = 0.9) # figure out dodged amount by trial and error
            ) +
  
  # use manual palette. 
  scale_fill_manual(values = rev(my_palette)) + 
  
  # Presentable axis labels
  scale_x_discrete(labels = c("Median age experienced \nabusive control", 
                              "Median age experienced \nemotional abuse", 
                              "Median age experienced \nphysical abuse")) +
  scale_y_continuous(expand = c(0, 0), # prevent expansion of scale
                     limits = c(0, 40) # expand scale to prevent clipping of labels
                     )  +
  labs(title = "Median ages within types of domestic violence with in wealth categories", 
       x = "", y = "Age (years)", fill = "Wealth category")  +
  theme_classic()
```

```{r fig.height = 4, width = 4}
#| fig.cap = "Figure 4. Median ages within types of domestic violence with in wealth categories "
gg_col_abuse_per_wealth_group
```

Figure 4 shows the median age of abuse victims for each of the three
types of abuse measired in this survey, grouped by the 5 wealth
categories. Out of all the women who were asked the domestic violence
module questions, `r pct_women_abuse_control`% suffered abusive control,
`r pct_women_abuse_emotional`% suffered emotional abuse and
`r pct_women_abuse_emotional`% suffered physical abuse. Across all three
types of abuse, there is a general trend that women in the wealthier
categories begin experiencing domestic violence later in life (except
for the second poorest category).

<!-- # Extra (failed) code attempts commented out - kept as a personal reference to come back to and correct one day. -->

<!-- ```{r} -->

<!-- ### Types of abuse per wealth category---- -->

<!-- ## Count women in each category of abuse -->

<!-- num_abuse_control <- complete_cases %>% group_by(wealth_index) %>%  filter(abuse_control == "yes") %>% nrow() -->

<!-- num_abuse_emotional <- complete_cases %>% filter(abuse_emotional == "yes") %>% nrow() -->

<!-- num_abuse_physical <- complete_cases %>% filter(abuse_physical == "yes") %>% nrow() -->

<!-- ## convert variables to binary and then factors to numbers -->

<!-- abused_women <- complete_cases %>% select(abuse_any, abuse_control, abuse_emotional, abuse_physical, wealth_index) %>%  -->

<!--   filter(abuse_any == "yes") %>%  -->

<!--   mutate(abuse_control_binary = case_when(abuse_control == "yes" ~1), -->

<!--          abuse_control_binary = as.numeric(as.character(abuse_control_binary)), -->

<!--          abuse_emotional_binary = case_when( -->

<!--                                            abuse_emotional == "yes" ~1), -->

<!--          abuse_emotional_binary = as.numeric(as.character(abuse_emotional_binary)), -->

<!--          abuse_physical_binary = case_when( -->

<!--                                            abuse_physical == "yes" ~1), -->

<!--          abuse_physical_binary = as.numeric(as.character(abuse_physical_binary))) -->

<!-- grouped_abused_women <- abused_women %>%  -->

<!--   group_by(wealth_index) %>%  -->

<!--   summarise(abuse_control_binary = n(), -->

<!--             abuse_emotional_binary = n(), -->

<!--             abuse_physical_binary = n()) %>%  -->

<!--   pivot_longer(2:4) %>%  -->

<!--   # pass the data directly into ggplot -->

<!--   Figure2 <- ggplot(abused_women) +  -->

<!--   geom_col(aes(x = wealth_index, y = value, fill = name), position = "dodge") +  -->

<!--   geom_text(aes(x = wealth_index, y = value - 1.2, group = name, label = value),  -->

<!--             size = 3.8, fontface = "bold", color = "white", -->

<!--             position = position_dodge(width = 0.9) # figure out dodged amount by trial and error -->

<!--             ) + -->

<!--   # use manual palette. Looks better reversed with `rev()` -->

<!--   scale_fill_manual(values = rev(my_palette)) +  -->

<!--   # Presentable x axis labels -->

<!--   scale_x_discrete(labels = c("Control",  -->

<!--                               "Emotional abuse",  -->

<!--                               "Physical abuse")) + -->

<!--   scale_y_continuous(expand = c(0, 0), # prevent expansion of scale -->

<!--                      limits = c(0, 27) # expand scale to prevent clipping of labels -->

<!--                      )  + -->

<!--   labs(title = "Median ages at key events by education group",  -->

<!--        x = "", y = "Age (years)", fill = "Education Level")  + -->

<!--   theme_classic() -->

<!-- print(Figure2) -->

<!-- gg_col_abuse_per_wealth_group <-  -->

<!--   complete_cases %>% select(abuse_any, abuse_control, abuse_emotional, abuse_physical, wealth_index) %>% -->

<!--   mutate(abuse_any_binary = case_when(abuse_any == "no" ~ 0, -->

<!--                                       abuse_any == "yes" ~1), -->

<!--          abuse_control_binary = case_when(abuse_control == "no" ~ 0, -->

<!--                                            abuse_control == "yes" ~1), -->

<!--          abuse_emotional_binary = case_when(abuse_emotional == "no" ~ 0, -->

<!--                                            abuse_emotional == "yes" ~1), -->

<!--          abuse_physical_binary = case_when(abuse_physical == "no" ~ 0, -->

<!--                                            abuse_physical == "yes" ~1)) %>%  -->

<!--   mutate(num_abuse_control = nrow(abuse_control_binary), -->

<!--             num_abuse_emotional = nrow(abuse_emotional_binary), -->

<!--             num_abuse_physical = nrow(abuse_physical_binary)) %>%  -->

<!--   group_by(wealth_index) %>% -->

<!--   pivot_longer(2:4) %>%  -->

<!--   # set the levels so that they show up in a sort of chronological order on ggplot -->

<!--   mutate(name = factor(name, -->

<!--                        levels = c("med_age_first_sex",  -->

<!--                                   "med_age_first_cohabitation",  -->

<!--                                   "med_age_first_birth"))) %>%  -->

<!--   # pass the data directly into ggplot -->

<!--   ggplot() +  -->

<!--   geom_col(aes(x = name, y = value, fill = educ), position = "dodge") +  -->

<!--   geom_text(aes(x = name, y = value - 1.2, group = educ, label = value),  -->

<!--             size = 3.8, fontface = "bold", color = "white", -->

<!--             position = position_dodge(width = 0.9) # figure out dodged amount by trial and error -->

<!--             ) + -->

<!--   # use manual palette. Looks better reversed with `rev()` -->

<!--   scale_fill_manual(values = rev(my_palette)) +  -->

<!--   # Presentable x axis labels -->

<!--   scale_x_discrete(labels = c("Median age \nat first sex",  -->

<!--                               "Median age \nat first cohabitation",  -->

<!--                               "Median age \nat first birth")) + -->

<!--   scale_y_continuous(expand = c(0, 0), # prevent expansion of scale -->

<!--                      limits = c(0, 27) # expand scale to prevent clipping of labels -->

<!--                      )  + -->

<!--   labs(title = "Median ages at key events by education group",  -->

<!--        x = "", y = "Age (years)", fill = "Education Level")  + -->

<!--   theme_classic() -->

<!-- ``` -->
